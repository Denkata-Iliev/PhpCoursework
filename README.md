# Php coursework - система за управление на стаите в университетски корпус

## Описание на заданието
Проектът пази информация за стаите в даден корпус на университет.

## Room (Стая)
| Поле | Тип | Описание |
|------|-----|----------|
| id | int,<br> primary key | първичен ключ |
| room_number | string,<br> unique | номер на стаята (уникален) |
| current_subject | string,<br> nullable | предметът, който се преподава в момента (ако има такъв) |
| is_free | boolean | флаг, посочващ дали стаята е свободна |
| user_id | int,<br> foreign key,<br> nullable | id-то на човека, който в момента е в стаята (ако има такъв) |
| photo_path | string,<br> nullable | път към снимката на стаята (ако има такава) |

## User (потребител) - standard from Jetstream
Полетата, които са използвани в проекта:

| Поле | Тип | Описание |
|------|-----|----------|
| id | int,<br> primary key | първичен ключ |
| name | string | име на потребителя |
| email | string,<br> unique | имейл на потребителя (уникален) |
| profile_photo_path | string,<br> nullable | път към профилната снимка на потребителя (ако има такава) |

## Roles and Permissions - Роли и Права
| Роля | Права | Описание |
|------|-------|----------|
| USER | access-rooms | Има правото да разглежда всички стаи, да взема и да освобождава стая. |
| ADMIN | access-rooms,<br> access-rooms-crud,<br> access-users | Има достъп до всичко в системата - създаване, редактиране, изтриване на стаи и потребители, както и създаване на нови админи. |

## Room Views (Изгледи на стая) 
| View | Роля | Описание |
|------|------|----------|
| index | ADMIN,<br> USER | Показва всички стаи, подредени по номер, дали са свободни, предметът, който се преподава в тях и човекът, който го преподава (ако има такива). Също има бутон за детайлен преглед на стаята и бутон за вземане на стаята (ако е свободна) или за освобождаване на стаята (ако логнатия потребител е този, който я е взел). |
| show | ADMIN,<br> USER | Подробен изглед на стаята с бутони за връщане към списъка със стаи, бутон за вземане или освобождаване на стаята |
| take | ADMIN,<br> USER | Препраща към форма, в която трябва да се попълни предмета, който ще се преподава в стаята, която потребителят иска да вземе. |
| edit | ADMIN | Препраща към форма за редактиране на стая. Редактира се само номера на стаята и снимката ѝ. |
| create | ADMIN | Препраща към форма за създаване на стая - попълва се номер на стая и снимка за нея (не е задължителна). | 

## Room Controller (Контролер за стаите)
| Метод | Описание |
|--------|----------|
| index,<br> create,<br> show,<br> edit,<br> take  | Проверяват дали потребителя има нужните права за достъпване на съответния изглед и препраща към него, ако да. Ако не - препраща към Forbidden страница със съответното съобщение. |
| store | Създава нова стая, като проверява дали има качена снимка за нея - ако да, записва снимката и прави url към нея. Ако не - дава url по подразбиране. |
| update | Обновява дадена стая, като проверява дали съответния номер вече съществува и ако да - проверява дали е на същата стая, ако да - позволява обновяването. Ако не - изписва съответното съобщение за грешка. Прави същата проверка за снимка, като в store. |
| takeRoom | Дава съответната стая на потребител, като записва съответния предмет, който потребителя е въвел и отбелязва стаята като заета. |
| dismiss | Отбелязва стаята като свободна и изчиства потребителя и предмета от нея. |
| destroy | Изтрива стаята от системата и снимката ѝ, ако такава съществува. |

## User Controller (Контролер за потребителите) - достъп имат само админите
| Метод | Описание |
|-------|----------|
| index,<br> create,<br> show,<br> edit | Проверяват дали потребителя има нужните права за достъпване на съответния изглед и препраща към него, ако да. Ако не - препраща към Forbidden страница със съответното съобщение. |
| store | Създава нов потребител или админ. |
| update | Обновява съответния потребител, като проверява дали имейла, който е въведен съществува, ако да - проверява дали е на този потребител, ако да - позволява обновяването. Ако не - изписва съобщение за грешката. Също проверява дали това е последния админ, ако да и ролята е променена - дава грешка, че не може да се промени ролята на последния админ в системата. |
| destroy | Проверява дали това е последния админ в системата - ако да, дава грешка, че последния админ не може да бъде изтрит. Ако не - изтрива потребителя и профилната му снимка (ако има такава). |
